<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport"
    content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover" />
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="theme-color" content="#000000">
  <link rel="manifest" href="/manifest.json">
  <link rel="apple-touch-icon" href="https://img.icons8.com/color/180/wallet--v1.png">
  <title>MyCashFlow</title>

  <!-- Fonts -->
  <link
    href="https://fonts.googleapis.com/css2?family=SF+Pro+Display:wght@400;500;600;700&family=Inter:wght@400;500;600&display=swap"
    rel="stylesheet">
  <!-- Icons -->
  <link href="https://cdn.jsdelivr.net/npm/remixicon@3.5.0/fonts/remixicon.css" rel="stylesheet">
</head>

<body>
  <div id="app">
    <!-- Top Bar -->
    <header class="mobile-header">
      <div class="header-left">
        <div class="avatar">me</div>
        <div class="greeting">
          <span class="sub">Welcome back,</span>
          <span class="name">Kons</span>
        </div>
      </div>
      <div class="header-right">
        <button class="icon-btn"><i class="ri-notification-3-line"></i></button>
      </div>
    </header>

    <!-- Scrollable Content -->
    <!-- Home View -->
    <div id="home-view" class="view-section active-view">
      <!-- Balance Card -->
      <section class="balance-card">
        <div class="balance-label">Total Balance</div>
        <div class="balance-amount">Rp 45.250.000</div>
        <div class="balance-stats">
          <div class="stat up">
            <i class="ri-arrow-up-circle-fill"></i>
            <span>+2.5jt Income</span>
          </div>
          <div class="stat down">
            <i class="ri-arrow-down-circle-fill"></i>
            <span>-1.2jt Expense</span>
          </div>
        </div>
      </section>

      <!-- Quick Actions -->
      <section class="quick-actions">
        <button class="action-btn">
          <div class="icon-box transfer"><i class="ri-exchange-dollar-line"></i></div>
          <span>Transfer</span>
        </button>
        <button class="action-btn">
          <div class="icon-box bill"><i class="ri-bill-line"></i></div>
          <span>Bill</span>
        </button>
        <button class="action-btn">
          <div class="icon-box topup"><i class="ri-wallet-3-line"></i></div>
          <span>Top Up</span>
        </button>
        <button class="action-btn">
          <div class="icon-box more"><i class="ri-grid-fill"></i></div>
          <span>More</span>
        </button>
      </section>

      <!-- Analytics -->
      <section class="section-title">
        <h3>Cashflow Trend</h3>
      </section>
      <div class="chart-container-mobile">
        <canvas id="cashflowChart"></canvas>
      </div>

      <!-- Recent Transactions -->
      <section class="section-title">
        <h3>Recent Activity</h3>
        <a href="#" class="see-all">See All</a>
      </section>
      <div class="transaction-list" id="transactionList">
        <!-- Populated by JS -->
      </div>

      <!-- Spacer -->
      <div style="height: 100px;"></div>
    </div>

    <!-- Stats View -->
    <div id="stats-view" class="view-section">
      <header class="mobile-header" style="position: sticky; top: 0;">
        <h3>Statistics</h3>
      </header>
      <div style="padding: 20px;">
        <div class="glass-card" style="padding: 20px; text-align: center; margin-bottom: 20px;">
          <h4 style="margin-bottom:15px; color:var(--text-secondary);">Expenses by Category</h4>
          <div style="height: 250px; position: relative;">
            <canvas id="expenseChart"></canvas>
          </div>
        </div>
        <div id="statsList" style="display: flex; flex-direction: column; gap: 10px;">
          <!-- JS will populate -->
        </div>
      </div>
    </div>

    <!-- Wallet View -->
    <div id="wallet-view" class="view-section">
      <header class="mobile-header" style="position: sticky; top: 0;">
        <h3>My Wallet</h3>
      </header>

      <div style="padding: 20px; display: flex; flex-direction: column; gap: 16px;">
        <!-- BCA Card -->
        <div class="wallet-card" style="background: linear-gradient(135deg, #10439F, #001F5C);">
          <div style="display:flex; justify-content:space-between; align-items:center;">
            <span class="card-logo">BCA</span>
            <i class="ri-visa-line card-icon"></i>
          </div>
          <div class="card-label">Balance</div>
          <div class="card-balance">Rp 15.200.000</div>
          <div class="card-number">**** 4432</div>
        </div>

        <!-- Gopay Card -->
        <div class="wallet-card" style="background: linear-gradient(135deg, #00ADD6, #007A99);">
          <div style="display:flex; justify-content:space-between; align-items:center;">
            <span class="card-logo">Gopay</span>
            <i class="ri-smartphone-line card-icon"></i>
          </div>
          <div class="card-label">Balance</div>
          <div class="card-balance">Rp 450.000</div>
          <div class="card-number">0812 **** 8888</div>
        </div>

        <!-- Cash Card -->
        <div class="wallet-card" style="background: linear-gradient(135deg, #34C759, #248A3D);">
          <div style="display:flex; justify-content:space-between; align-items:center;">
            <span class="card-logo">Cash</span>
            <i class="ri-money-dollar-circle-line card-icon"></i>
          </div>
          <div class="card-label">On Hand</div>
          <div class="card-balance">Rp 1.500.000</div>
        </div>
      </div>
    </div>

    <!-- Profile View -->
    <div id="profile-view" class="view-section">
      <header class="mobile-header" style="position: sticky; top: 0;">
        <h3>Profile</h3>
      </header>
      <div class="placeholder-view">
        <i class="ri-user-3-line"></i>
        <h3>User Profile</h3>
        <p>Settings and preferences</p>
      </div>
    </div>

    <!-- Add Transaction Modal -->
    <div class="modal-overlay" id="addModal">
      <div class="bottom-sheet">
        <div class="sheet-header">
          <h3>New Transaction</h3>
          <button class="close-btn" id="closeModal"><i class="ri-close-line"></i></button>
        </div>
        <form id="trxForm" class="trx-form">
          <div class="form-group">
            <label>Amount (Rp)</label>
            <input type="number" id="trxAmount" placeholder="0" required inputmode="numeric">
          </div>
          <div class="form-group">
            <label>Description</label>
            <input type="text" id="trxTitle" placeholder="e.g. Nasi Goreng" required>
          </div>
          <div class="form-group">
            <label>Category</label>
            <select id="trxCategory">
              <option value="Food">üçî Food</option>
              <option value="Transport">üöï Transport</option>
              <option value="Shopping">üõçÔ∏è Shopping</option>
              <option value="Entertainment">üé¨ Entertainment</option>
              <option value="Income">üí∞ Income</option>
            </select>
          </div>
          <button type="submit" class="save-btn">Save Transaction</button>
        </form>
      </div>
    </div>

    <!-- Bottom Navigation -->
    <nav class="bottom-nav">
      <a href="#" class="nav-item active" data-tab="home">
        <i class="ri-home-5-line"></i>
        <span>Home</span>
      </a>
      <a href="#" class="nav-item" data-tab="stats">
        <i class="ri-pie-chart-2-line"></i>
        <span>Stats</span>
      </a>
      <div class="nav-fab">
        <i class="ri-add-line"></i>
      </div>
      <a href="#" class="nav-item" data-tab="wallet">
        <i class="ri-wallet-3-line"></i>
        <span>Wallet</span>
      </a>
      <a href="#" class="nav-item" data-tab="profile">
        <i class="ri-user-3-line"></i>
        <span>Profile</span>
      </a>
    </nav>

    <!-- GitHub Library: pwa-install -->
    <pwa-install id="pwa-install" name="MyCashFlow" icon="/icon-192.png" manifest-url="/manifest.json"
      manual-apple="true">
    </pwa-install>

    <script>
      // Force show instructions on iOS if not installed
      window.addEventListener('load', () => {
        const pwaInstall = document.getElementById('pwa-install');
        // Check if iOS and not standalone
        const isIOS = /iPad|iPhone|iPod/.test(navigator.userAgent) && !window.MSStream;
        const isStandalone = window.navigator.standalone;

        if (isIOS && !isStandalone) {
          // Show the prompt (library handles the UI)
          setTimeout(() => {
            if (pwaInstall && pwaInstall.showDialog) {
              pwaInstall.showDialog(true);
            }
          }, 3000);
        }
      });
    </script>
  </div>
  <script type="module" src="/main.js"></script>
</body>

</html>